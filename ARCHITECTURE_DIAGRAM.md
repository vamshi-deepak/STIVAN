# ğŸ”„ Forgot Password - System Architecture

## System Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          FORGOT PASSWORD FLOW                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend   â”‚         â”‚   Backend    â”‚         â”‚    Gmail     â”‚
â”‚   (React)    â”‚         â”‚  (Node.js)   â”‚         â”‚    SMTP      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: Request OTP                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                        â”‚                        â”‚
       â”‚  POST /request-otp     â”‚                        â”‚
       â”‚  { email: "..." }      â”‚                        â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚                   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                  â”‚
       â”‚                   â”‚ Validate â”‚                  â”‚
       â”‚                   â”‚  Email   â”‚                  â”‚
       â”‚                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                  â”‚
       â”‚                        â”‚                        â”‚
       â”‚                   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                  â”‚
       â”‚                   â”‚ Find Userâ”‚                  â”‚
       â”‚                   â”‚ in MongoDBâ”‚                 â”‚
       â”‚                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                  â”‚
       â”‚                        â”‚                        â”‚
       â”‚                   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                  â”‚
       â”‚                   â”‚ Generate â”‚                  â”‚
       â”‚                   â”‚ 6-digit  â”‚                  â”‚
       â”‚                   â”‚   OTP    â”‚                  â”‚
       â”‚                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                  â”‚
       â”‚                        â”‚                        â”‚
       â”‚                   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                  â”‚
       â”‚                   â”‚Store OTP â”‚                  â”‚
       â”‚                   â”‚& Expiry  â”‚                  â”‚
       â”‚                   â”‚in Databaseâ”‚                 â”‚
       â”‚                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                  â”‚
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚  Send Email via SMTP   â”‚
       â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
       â”‚                        â”‚  { to, subject, html } â”‚
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚                   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
       â”‚                        â”‚                   â”‚ Deliver  â”‚
       â”‚                        â”‚                   â”‚  Email   â”‚
       â”‚                        â”‚                   â”‚ to User  â”‚
       â”‚                        â”‚                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
       â”‚  { success: true }     â”‚                        â”‚
       â”‚  "OTP sent to email"   â”‚                        â”‚
       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER: Checks email inbox and retrieves OTP code                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: Verify OTP                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                        â”‚                        â”‚
       â”‚  POST /verify-otp      â”‚                        â”‚
       â”‚  { email, otp }        â”‚                        â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚                   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                  â”‚
       â”‚                   â”‚Find User â”‚                  â”‚
       â”‚                   â”‚by Email  â”‚                  â”‚
       â”‚                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                  â”‚
       â”‚                        â”‚                        â”‚
       â”‚                   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                  â”‚
       â”‚                   â”‚Compare   â”‚                  â”‚
       â”‚                   â”‚OTP Code  â”‚                  â”‚
       â”‚                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                  â”‚
       â”‚                        â”‚                        â”‚
       â”‚                   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                  â”‚
       â”‚                   â”‚Check     â”‚                  â”‚
       â”‚                   â”‚Expiry    â”‚                  â”‚
       â”‚                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                  â”‚
       â”‚                        â”‚                        â”‚
       â”‚  { success: true }     â”‚                        â”‚
       â”‚  "OTP verified"        â”‚                        â”‚
       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚                        â”‚                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: Reset Password                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                        â”‚                        â”‚
       â”‚  POST /reset-password  â”‚                        â”‚
       â”‚  { email, otp,         â”‚                        â”‚
       â”‚    newPassword }       â”‚                        â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚                   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                  â”‚
       â”‚                   â”‚Find User â”‚                  â”‚
       â”‚                   â”‚& Verify  â”‚                  â”‚
       â”‚                   â”‚   OTP    â”‚                  â”‚
       â”‚                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                  â”‚
       â”‚                        â”‚                        â”‚
       â”‚                   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                  â”‚
       â”‚                   â”‚Hash New  â”‚                  â”‚
       â”‚                   â”‚Password  â”‚                  â”‚
       â”‚                   â”‚(bcrypt)  â”‚                  â”‚
       â”‚                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                  â”‚
       â”‚                        â”‚                        â”‚
       â”‚                   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                  â”‚
       â”‚                   â”‚Update    â”‚                  â”‚
       â”‚                   â”‚Password  â”‚                  â”‚
       â”‚                   â”‚in DB     â”‚                  â”‚
       â”‚                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                  â”‚
       â”‚                        â”‚                        â”‚
       â”‚                   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                  â”‚
       â”‚                   â”‚Clear OTP â”‚                  â”‚
       â”‚                   â”‚from DB   â”‚                  â”‚
       â”‚                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                  â”‚
       â”‚                        â”‚                        â”‚
       â”‚  { success: true }     â”‚                        â”‚
       â”‚  "Password reset"      â”‚                        â”‚
       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
       â”‚                        â”‚                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 4: Auto-Redirect & Login                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                        â”‚                        â”‚
       â”‚  Show Success          â”‚                        â”‚
       â”‚  Countdown: 3...2...1  â”‚                        â”‚
       â”‚  Navigate to /login    â”‚                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚  POST /login           â”‚                        â”‚
       â”‚  { email, newPassword }â”‚                        â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚
       â”‚                        â”‚                        â”‚
       â”‚                   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                  â”‚
       â”‚                   â”‚Verify    â”‚                  â”‚
       â”‚                   â”‚Password  â”‚                  â”‚
       â”‚                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                  â”‚
       â”‚                        â”‚                        â”‚
       â”‚                   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                  â”‚
       â”‚                   â”‚Generate  â”‚                  â”‚
       â”‚                   â”‚JWT Token â”‚                  â”‚
       â”‚                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                  â”‚
       â”‚                        â”‚                        â”‚
       â”‚  { token, user }       â”‚                        â”‚
       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
       â”‚                        â”‚                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SUCCESS: User logged in with new password âœ…                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Component Breakdown

### Frontend Components

```
ForgotPassword.js
â”œâ”€â”€ Step 1: Request OTP Form
â”‚   â”œâ”€â”€ Email input field
â”‚   â”œâ”€â”€ Send OTP button
â”‚   â””â”€â”€ Back to login link
â”‚
â”œâ”€â”€ Step 2: Verify OTP Form
â”‚   â”œâ”€â”€ OTP input (6 digits)
â”‚   â”œâ”€â”€ Verify button
â”‚   â””â”€â”€ Resend OTP link
â”‚
â”œâ”€â”€ Step 3: Reset Password Form
â”‚   â”œâ”€â”€ New password input
â”‚   â”œâ”€â”€ Confirm password input
â”‚   â”œâ”€â”€ Password strength indicator
â”‚   â””â”€â”€ Reset button
â”‚
â””â”€â”€ Step 4: Success Message
    â”œâ”€â”€ Success icon & message
    â”œâ”€â”€ Countdown timer (3s)
    â””â”€â”€ Manual login button
```

### Backend Components

```
Auth System
â”œâ”€â”€ Routes (authRoutes.js)
â”‚   â”œâ”€â”€ POST /api/auth/request-otp
â”‚   â”œâ”€â”€ POST /api/auth/verify-otp
â”‚   â””â”€â”€ POST /api/auth/reset-password
â”‚
â”œâ”€â”€ Controller (authController.js)
â”‚   â”œâ”€â”€ requestOtp() - Generate & send OTP
â”‚   â”œâ”€â”€ verifyOtp() - Validate OTP
â”‚   â””â”€â”€ resetPassword() - Update password
â”‚
â”œâ”€â”€ Service (mailer.js)
â”‚   â”œâ”€â”€ SMTP configuration
â”‚   â”œâ”€â”€ sendMail() - Email delivery
â”‚   â””â”€â”€ HTML template formatting
â”‚
â””â”€â”€ Model (User.js)
    â”œâ”€â”€ generateOtp() - Create OTP
    â”œâ”€â”€ verifyOtp() - Check OTP validity
    â””â”€â”€ password hashing (bcrypt)
```

---

## Data Flow

### Database Schema (User Model)

```javascript
User {
  _id: ObjectId
  name: String
  email: String (unique, indexed)
  password: String (hashed)
  
  // OTP Fields
  otp: String              // 6-digit code
  otpExpires: Date         // Expiration timestamp
  
  // Security Fields
  loginAttempts: Number
  lockUntil: Date
  isActive: Boolean
  
  // Metadata
  createdAt: Date
  updatedAt: Date
}
```

### OTP Lifecycle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  OTP Creation (generateOtp)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Generate random 6-digit number       â”‚
â”‚ 2. Set expiry: now + 10 minutes         â”‚
â”‚ 3. Store in user.otp field              â”‚
â”‚ 4. Store expiry in user.otpExpires      â”‚
â”‚ 5. Return OTP to send via email         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  OTP Verification (verifyOtp)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Check if OTP exists                  â”‚
â”‚ 2. Check if OTP not expired             â”‚
â”‚ 3. Compare provided OTP with stored     â”‚
â”‚ 4. If valid: clear OTP from DB          â”‚
â”‚ 5. Return true/false                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Security Measures

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Security Layer 1: Input Validation                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… Email format validation                          â”‚
â”‚ âœ… OTP must be exactly 6 digits                     â”‚
â”‚ âœ… Password minimum 8 characters                    â”‚
â”‚ âœ… SQL injection prevention                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Security Layer 2: OTP Protection                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… OTP expires after 10 minutes                     â”‚
â”‚ âœ… OTP cleared after successful use                 â”‚
â”‚ âœ… One OTP per user at a time                       â”‚
â”‚ âœ… Cannot reuse expired OTP                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Security Layer 3: Password Security                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… Passwords hashed with bcrypt (10 rounds)         â”‚
â”‚ âœ… Never stored in plain text                       â”‚
â”‚ âœ… Password strength validation                     â”‚
â”‚ âœ… Confirmation required before update              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Security Layer 4: Communication Security           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… HTTPS for API calls                              â”‚
â”‚ âœ… TLS for email (port 587)                         â”‚
â”‚ âœ… JWT tokens for authentication                    â”‚
â”‚ âœ… CORS protection                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Error Handling

```
Frontend Error States:
â”œâ”€â”€ Network errors â†’ "Connection failed, try again"
â”œâ”€â”€ Invalid email â†’ "Please enter a valid email"
â”œâ”€â”€ User not found â†’ "No account with this email"
â”œâ”€â”€ Wrong OTP â†’ "Invalid code, please try again"
â”œâ”€â”€ Expired OTP â†’ "Code expired, request new one"
â”œâ”€â”€ Password mismatch â†’ "Passwords don't match"
â””â”€â”€ Weak password â†’ "Password must be 8+ characters"

Backend Error Responses:
â”œâ”€â”€ 400 Bad Request â†’ Invalid input data
â”œâ”€â”€ 401 Unauthorized â†’ Invalid credentials
â”œâ”€â”€ 404 Not Found â†’ User doesn't exist
â”œâ”€â”€ 429 Too Many Requests â†’ Rate limit exceeded
â””â”€â”€ 500 Server Error â†’ Unexpected error
```

---

## Email Template Structure

```html
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STIVAN Logo & Header               â”‚
â”‚  (Purple gradient background)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                      â”‚
â”‚  Hello [User Name],                  â”‚
â”‚                                      â”‚
â”‚  We received a password reset        â”‚
â”‚  request for your account.           â”‚
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  Your verification code â”‚          â”‚
â”‚  â”‚                         â”‚          â”‚
â”‚  â”‚      123456            â”‚          â”‚
â”‚  â”‚                         â”‚          â”‚
â”‚  â”‚  Valid for 10 minutes   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                      â”‚
â”‚  âš ï¸ Security Notice:                â”‚
â”‚  If you didn't request this...      â”‚
â”‚                                      â”‚
â”‚  Best regards,                       â”‚
â”‚  STIVAN Support Team                 â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  Footer: Automated message          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Testing Scenarios

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Test Case Matrix                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  âœ… Happy Path                      â”‚
â”‚  â”œâ”€ Valid email â†’ OTP sent          â”‚
â”‚  â”œâ”€ Correct OTP â†’ Verified          â”‚
â”‚  â”œâ”€ New password â†’ Updated          â”‚
â”‚  â””â”€ Login â†’ Success                 â”‚
â”‚                                     â”‚
â”‚  âš ï¸  Error Cases                    â”‚
â”‚  â”œâ”€ Invalid email â†’ 404             â”‚
â”‚  â”œâ”€ Wrong OTP â†’ 400                 â”‚
â”‚  â”œâ”€ Expired OTP â†’ 400               â”‚
â”‚  â”œâ”€ Weak password â†’ Rejected        â”‚
â”‚  â””â”€ Mismatch password â†’ Error       â”‚
â”‚                                     â”‚
â”‚  ğŸ”„ Edge Cases                      â”‚
â”‚  â”œâ”€ Resend OTP â†’ New code           â”‚
â”‚  â”œâ”€ Multiple attempts â†’ Limit       â”‚
â”‚  â”œâ”€ Back navigation â†’ State reset   â”‚
â”‚  â””â”€ Auto-redirect â†’ Timer works     â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Performance Metrics

```
Expected Performance:
â”œâ”€â”€ OTP Generation: < 100ms
â”œâ”€â”€ Email Sending: 1-3 seconds
â”œâ”€â”€ OTP Verification: < 50ms
â”œâ”€â”€ Password Update: < 200ms
â”œâ”€â”€ Frontend Load: < 1 second
â””â”€â”€ Total Flow Time: < 2 minutes
```

---

## Monitoring & Logs

```
Backend Logs:
â”œâ”€â”€ [INFO] OTP requested for: user@example.com
â”œâ”€â”€ [INFO] âœ“ Email sent successfully
â”œâ”€â”€ [INFO] OTP verified for: user@example.com
â”œâ”€â”€ [INFO] Password reset successful
â”œâ”€â”€ [ERROR] Failed to send email: [reason]
â””â”€â”€ [WARN] Invalid OTP attempt: user@example.com

Email Service Logs:
â”œâ”€â”€ âœ“ SMTP connection established
â”œâ”€â”€ âœ“ Email queued for delivery
â”œâ”€â”€ âœ“ Email delivered successfully
â””â”€â”€ âœ— Delivery failed: [reason]
```

---

## Deployment Architecture

```
Production Environment:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Load Balancer  â”‚â”€â”€â”€â”€â”€â–ºâ”‚  Frontend        â”‚
â”‚   (CDN/Nginx)    â”‚      â”‚  (React Build)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ API Calls
                                    â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚  Backend         â”‚
                          â”‚  (Node.js)       â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚              â”‚              â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   MongoDB     â”‚  â”‚  Gmail   â”‚  â”‚   Redis  â”‚
            â”‚   Database    â”‚  â”‚  SMTP    â”‚  â”‚  Cache   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Version**: 1.0  
**Last Updated**: October 13, 2025  
**Status**: Production Ready
